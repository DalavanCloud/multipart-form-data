<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" 
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html lang="en" xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head profile="http://www.w3.org/2006/03/hcard http://dublincore.org/documents/2008/08/04/dc-html/">
  <meta http-equiv="Content-Type" content="text/html; charset=us-ascii" />

  <title>Returning Values from Forms: multipart/form-data</title>

  <style type="text/css" title="Xml2Rfc (sans serif)">
  /*<![CDATA[*/
	  a {
	  text-decoration: none;
	  }
      /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
      a.info {
          /* This is the key. */
          position: relative;
          z-index: 24;
          text-decoration: none;
      }
      a.info:hover {
          z-index: 25;
          color: #FFF; background-color: #900;
      }
      a.info span { display: none; }
      a.info:hover span.info {
          /* The span will display just on :hover state. */
          display: block;
          position: absolute;
          font-size: smaller;
          top: 2em; left: -5em; width: 15em;
          padding: 2px; border: 1px solid #333;
          color: #900; background-color: #EEE;
          text-align: left;
      }
	  a.smpl {
	  color: black;
	  }
	  a:hover {
	  text-decoration: underline;
	  }
	  a:active {
	  text-decoration: underline;
	  }
	  address {
	  margin-top: 1em;
	  margin-left: 2em;
	  font-style: normal;
	  }
	  body {
	  color: black;
	  font-family: verdana, helvetica, arial, sans-serif;
	  font-size: 10pt;
	  max-width: 55em;
	  
	  }
	  cite {
	  font-style: normal;
	  }
	  dd {
	  margin-right: 2em;
	  }
	  dl {
	  margin-left: 2em;
	  }
	
	  ul.empty {
	  list-style-type: none;
	  }
	  ul.empty li {
	  margin-top: .5em;
	  }
	  dl p {
	  margin-left: 0em;
	  }
	  dt {
	  margin-top: .5em;
	  }
	  h1 {
	  font-size: 14pt;
	  line-height: 21pt;
	  page-break-after: avoid;
	  }
	  h1.np {
	  page-break-before: always;
	  }
	  h1 a {
	  color: #333333;
	  }
	  h2 {
	  font-size: 12pt;
	  line-height: 15pt;
	  page-break-after: avoid;
	  }
	  h3, h4, h5, h6 {
	  font-size: 10pt;
	  page-break-after: avoid;
	  }
	  h2 a, h3 a, h4 a, h5 a, h6 a {
	  color: black;
	  }
	  img {
	  margin-left: 3em;
	  }
	  li {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  ol {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  ol p {
	  margin-left: 0em;
	  }
	  p {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  pre {
	  margin-left: 3em;
	  background-color: lightyellow;
	  padding: .25em;
	  }
	  pre.text2 {
	  border-style: dotted;
	  border-width: 1px;
	  background-color: #f0f0f0;
	  width: 69em;
	  }
	  pre.inline {
	  background-color: white;
	  padding: 0em;
	  }
	  pre.text {
	  border-style: dotted;
	  border-width: 1px;
	  background-color: #f8f8f8;
	  width: 69em;
	  }
	  pre.drawing {
	  border-style: solid;
	  border-width: 1px;
	  background-color: #f8f8f8;
	  padding: 2em;
	  }
	  table {
	  margin-left: 2em;
	  }
	  table.tt {
	  vertical-align: top;
	  }
	  table.full {
	  border-style: outset;
	  border-width: 1px;
	  }
	  table.headers {
	  border-style: outset;
	  border-width: 1px;
	  }
	  table.tt td {
	  vertical-align: top;
	  }
	  table.full td {
	  border-style: inset;
	  border-width: 1px;
	  }
	  table.tt th {
	  vertical-align: top;
	  }
	  table.full th {
	  border-style: inset;
	  border-width: 1px;
	  }
	  table.headers th {
	  border-style: none none inset none;
	  border-width: 1px;
	  }
	  table.left {
	  margin-right: auto;
	  }
	  table.right {
	  margin-left: auto;
	  }
	  table.center {
	  margin-left: auto;
	  margin-right: auto;
	  }
	  caption {
	  caption-side: bottom;
	  font-weight: bold;
	  font-size: 9pt;
	  margin-top: .5em;
	  }
	
	  table.header {
	  border-spacing: 1px;
	  width: 95%;
	  font-size: 10pt;
	  color: white;
	  }
	  td.top {
	  vertical-align: top;
	  }
	  td.topnowrap {
	  vertical-align: top;
	  white-space: nowrap; 
	  }
	  table.header td {
	  background-color: gray;
	  width: 50%;
	  }
	  table.header a {
	  color: white;
	  }
	  td.reference {
	  vertical-align: top;
	  white-space: nowrap;
	  padding-right: 1em;
	  }
	  thead {
	  display:table-header-group;
	  }
	  ul.toc, ul.toc ul {
	  list-style: none;
	  margin-left: 1.5em;
	  margin-right: 0em;
	  padding-left: 0em;
	  }
	  ul.toc li {
	  line-height: 150%;
	  font-weight: bold;
	  font-size: 10pt;
	  margin-left: 0em;
	  margin-right: 0em;
	  }
	  ul.toc li li {
	  line-height: normal;
	  font-weight: normal;
	  font-size: 9pt;
	  margin-left: 0em;
	  margin-right: 0em;
	  }
	  li.excluded {
	  font-size: 0pt;
	  }
	  ul p {
	  margin-left: 0em;
	  }
	
	  .comment {
	  background-color: yellow;
	  }
	  .center {
	  text-align: center;
	  }
	  .error {
	  color: red;
	  font-style: italic;
	  font-weight: bold;
	  }
	  .figure {
	  font-weight: bold;
	  text-align: center;
	  font-size: 9pt;
	  }
	  .filename {
	  color: #333333;
	  font-weight: bold;
	  font-size: 12pt;
	  line-height: 21pt;
	  text-align: center;
	  }
	  .fn {
	  font-weight: bold;
	  }
	  .hidden {
	  display: none;
	  }
	  .left {
	  text-align: left;
	  }
	  .right {
	  text-align: right;
	  }
	  .title {
	  color: #990000;
	  font-size: 18pt;
	  line-height: 18pt;
	  font-weight: bold;
	  text-align: center;
	  margin-top: 36pt;
	  }
	  .vcardline {
	  display: block;
	  }
	  .warning {
	  font-size: 14pt;
	  background-color: yellow;
	  }
	
	
	  @media print {
	  .noprint {
		display: none;
	  }
	
	  a {
		color: black;
		text-decoration: none;
	  }
	
	  table.header {
		width: 90%;
	  }
	
	  td.header {
		width: 50%;
		color: black;
		background-color: white;
		vertical-align: top;
		font-size: 12pt;
	  }
	
	  ul.toc a::after {
		content: leader('.') target-counter(attr(href), page);
	  }
	
	  ul.ind li li a {
		content: target-counter(attr(href), page);
	  }
	
	  .print2col {
		column-count: 2;
		-moz-column-count: 2;
		column-fill: auto;
	  }
	  }
	
	  @page {
	  @top-left {
		   content: "Internet-Draft"; 
	  } 
	  @top-right {
		   content: "December 2010"; 
	  } 
	  @top-center {
		   content: "Abbreviated Title";
	  } 
	  @bottom-left {
		   content: "Doe"; 
	  } 
	  @bottom-center {
		   content: "Expires June 2011"; 
	  } 
	  @bottom-right {
		   content: "[Page " counter(page) "]"; 
	  } 
	  }
	
	  @page:first { 
		@top-left {
		  content: normal;
		}
		@top-right {
		  content: normal;
		}
		@top-center {
		  content: normal;
		}
	  }
  /*]]>*/
  </style>

  <link href="#rfc.toc" rel="Contents"/>
<link href="#rfc.section.1" rel="Chapter" title="1 NOTE"/>
<link href="#rfc.section.2" rel="Chapter" title="2 Introduction"/>
<link href="#rfc.section.3" rel="Chapter" title="3 Advise for Forms and Form Processing"/>
<link href="#rfc.section.4" rel="Chapter" title="4 Definition of multipart/form-data"/>
<link href="#rfc.section.4.1" rel="Chapter" title="4.1 Boundary"/>
<link href="#rfc.section.4.2" rel="Chapter" title="4.2 filename attribute"/>
<link href="#rfc.section.4.3" rel="Chapter" title="4.3 Multiple files for one form field"/>
<link href="#rfc.section.4.4" rel="Chapter" title="4.4 Content-Type"/>
<link href="#rfc.section.4.5" rel="Chapter" title="4.5 The text/plain charset parameter for text fields"/>
<link href="#rfc.section.4.6" rel="Chapter" title="4.6 The _charset_ field for default charset"/>
<link href="#rfc.section.4.7" rel="Chapter" title="4.7 Content-Transfer-Encoding deprecated"/>
<link href="#rfc.section.4.8" rel="Chapter" title="4.8 Other Content- headers"/>
<link href="#rfc.section.5" rel="Chapter" title="5 URL encoding non-ASCII values"/>
<link href="#rfc.section.6" rel="Chapter" title="6 Operability considerations"/>
<link href="#rfc.section.6.1" rel="Chapter" title="6.1 Non-ASCII field names and values"/>
<link href="#rfc.section.6.1.1" rel="Chapter" title="6.1.1 Avoid non-ASCII field names"/>
<link href="#rfc.section.6.1.2" rel="Chapter" title="6.1.2 Interpreting forms and creating form-data"/>
<link href="#rfc.section.6.1.3" rel="Chapter" title="6.1.3 Parsing and interpreting form data"/>
<link href="#rfc.section.6.2" rel="Chapter" title="6.2 Ordered fields and duplicated field names"/>
<link href="#rfc.section.6.3" rel="Chapter" title="6.3 Interoperability with web applications"/>
<link href="#rfc.section.6.4" rel="Chapter" title="6.4 Correlating form data with the original form"/>
<link href="#rfc.section.7" rel="Chapter" title="7 IANA Considerations"/>
<link href="#rfc.section.8" rel="Chapter" title="8 Security Considerations"/>
<link href="#rfc.section.9" rel="Chapter" title="9 Media type registration for multipart/form-data"/>
<link href="#rfc.references" rel="Chapter" title="10 References"/>
<link href="#rfc.references.1" rel="Chapter" title="10.1 Normative References"/>
<link href="#rfc.references.2" rel="Chapter" title="10.2 Informative References"/>
<link href="#rfc.appendix.A" rel="Chapter" title="A Changes from RFC 2388"/>
<link href="#rfc.appendix.B" rel="Chapter" title="B Alternatives"/>
<link href="#rfc.authors" rel="Chapter"/>


  <meta name="generator" content="xml2rfc version 2.4.9dev0 - http://tools.ietf.org/tools/xml2rfc" />
  <link rel="schema.dct" href="http://purl.org/dc/terms/" />

  <meta name="dct.creator" content="Masinter, L." />
  <meta name="dct.identifier" content="urn:ietf:id:draft-ietf-appsawg-multipart-form-data-04" />
  <meta name="dct.issued" scheme="ISO8601" content="2014-7-5" />
  <meta name="dct.abstract" content="This specification (re)defines the multipart/form-data Internet Media Type, which can be used by a wide variety of applications and transported by a wide variety of protocols as a way of returning a set of values as the result of a user filling out a form.  It replaces RFC 2388.  " />
  <meta name="description" content="This specification (re)defines the multipart/form-data Internet Media Type, which can be used by a wide variety of applications and transported by a wide variety of protocols as a way of returning a set of values as the result of a user filling out a form.  It replaces RFC 2388.  " />

</head>

<body>

  <table class="header">
    <tbody>
    
    	<tr>
  <td class="left">Network Working Group</td>
  <td class="right">L. Masinter</td>
</tr>
<tr>
  <td class="left">Internet-Draft</td>
  <td class="right">Adobe</td>
</tr>
<tr>
  <td class="left">Obsoletes: 2388 (if approved)</td>
  <td class="right">July 5, 2014</td>
</tr>
<tr>
  <td class="left">Intended status: Standards Track</td>
  <td class="right"></td>
</tr>
<tr>
  <td class="left">Expires: January 6, 2015</td>
  <td class="right"></td>
</tr>

    	
    </tbody>
  </table>

  <p class="title">Returning Values from Forms: multipart/form-data<br />
  <span class="filename">draft-ietf-appsawg-multipart-form-data-04</span></p>
  
  <h1 id="rfc.abstract">
  <a href="#rfc.abstract">Abstract</a>
</h1>
<p>This specification (re)defines the multipart/form-data Internet Media Type, which can be used by a wide variety of applications and transported by a wide variety of protocols as a way of returning a set of values as the result of a user filling out a form.  It replaces RFC 2388.  </p>
<h1 id="rfc.status">
  <a href="#rfc.status">Status of This Memo</a>
</h1>
<p>This Internet-Draft is submitted in full conformance with the provisions of BCP 78 and BCP 79.</p>
<p>Internet-Drafts are working documents of the Internet Engineering Task Force (IETF).  Note that other groups may also distribute working documents as Internet-Drafts.  The list of current Internet-Drafts is at http://datatracker.ietf.org/drafts/current/.</p>
<p>Internet-Drafts are draft documents valid for a maximum of six months and may be updated, replaced, or obsoleted by other documents at any time.  It is inappropriate to use Internet-Drafts as reference material or to cite them other than as "work in progress."</p>
<p>This Internet-Draft will expire on January 6, 2015.</p>
<h1 id="rfc.copyrightnotice">
  <a href="#rfc.copyrightnotice">Copyright Notice</a>
</h1>
<p>Copyright (c) 2014 IETF Trust and the persons identified as the document authors.  All rights reserved.</p>
<p>This document is subject to BCP 78 and the IETF Trust's Legal Provisions Relating to IETF Documents (http://trustee.ietf.org/license-info) in effect on the date of publication of this document.  Please review these documents carefully, as they describe your rights and restrictions with respect to this document.  Code Components extracted from this document must include Simplified BSD License text as described in Section 4.e of the Trust Legal Provisions and are provided without warranty as described in the Simplified BSD License.</p>

  
  <hr class="noprint" />
  <h1 class="np" id="rfc.toc"><a href="#rfc.toc">Table of Contents</a></h1>
  <ul class="toc">

  	<li>1.   <a href="#rfc.section.1">NOTE</a></li>
<li>2.   <a href="#rfc.section.2">Introduction</a></li>
<li>3.   <a href="#rfc.section.3">Advise for Forms and Form Processing</a></li>
<li>4.   <a href="#rfc.section.4">Definition of multipart/form-data</a></li>
<ul><li>4.1.   <a href="#rfc.section.4.1">Boundary</a></li>
<li>4.2.   <a href="#rfc.section.4.2">filename attribute</a></li>
<li>4.3.   <a href="#rfc.section.4.3">Multiple files for one form field</a></li>
<li>4.4.   <a href="#rfc.section.4.4">Content-Type</a></li>
<li>4.5.   <a href="#rfc.section.4.5">The text/plain charset parameter for text fields</a></li>
<li>4.6.   <a href="#rfc.section.4.6">The _charset_ field for default charset</a></li>
<li>4.7.   <a href="#rfc.section.4.7">Content-Transfer-Encoding deprecated</a></li>
<li>4.8.   <a href="#rfc.section.4.8">Other Content- headers</a></li>
</ul><li>5.   <a href="#rfc.section.5">URL encoding non-ASCII values</a></li>
<li>6.   <a href="#rfc.section.6">Operability considerations</a></li>
<ul><li>6.1.   <a href="#rfc.section.6.1">Non-ASCII field names and values</a></li>
<ul><li>6.1.1.   <a href="#rfc.section.6.1.1">Avoid non-ASCII field names</a></li>
<li>6.1.2.   <a href="#rfc.section.6.1.2">Interpreting forms and creating form-data</a></li>
<li>6.1.3.   <a href="#rfc.section.6.1.3">Parsing and interpreting form data</a></li>
</ul><li>6.2.   <a href="#rfc.section.6.2">Ordered fields and duplicated field names</a></li>
<li>6.3.   <a href="#rfc.section.6.3">Interoperability with web applications</a></li>
<li>6.4.   <a href="#rfc.section.6.4">Correlating form data with the original form</a></li>
</ul><li>7.   <a href="#rfc.section.7">IANA Considerations</a></li>
<li>8.   <a href="#rfc.section.8">Security Considerations</a></li>
<li>9.   <a href="#rfc.section.9">Media type registration for multipart/form-data</a></li>
<li>10.   <a href="#rfc.references">References</a></li>
<ul><li>10.1.   <a href="#rfc.references.1">Normative References</a></li>
<li>10.2.   <a href="#rfc.references.2">Informative References</a></li>
</ul><li>Appendix A.   <a href="#rfc.appendix.A">Changes from RFC 2388</a></li>
<li>Appendix B.   <a href="#rfc.appendix.B">Alternatives</a></li>
<li><a href="#rfc.authors">Author's Address</a></li>


  </ul>

  <h1 id="rfc.section.1"><a href="#rfc.section.1">1.</a> NOTE</h1>
<p id="rfc.section.1.p.1">There is a GitHub repository for this draft at https://github.com/masinter/multipart-form-data along with an issue tracker. This specification is a work item of the APPSAWG Applications Area working group, apps-discuss@ietf.org. Please raise issues in the tracker, and/or send to the apps-discuss list.</p>
<h1 id="rfc.section.2"><a href="#rfc.section.2">2.</a> Introduction</h1>
<p id="rfc.section.2.p.1">In many applications, it is possible for a user to be presented with a form. The user will fill out the form, including information that is typed, generated by user input, or included from files that the user has selected. When the form is filled out, the data from the form is sent from the user to the receiving application.  </p>
<p id="rfc.section.2.p.2">The definition of <samp>multipart/form-data</samp> is derived from one of those applications, originally set out in <a href="#RFC1867">[RFC1867]</a> and subsequently incorporated into <a href="#HTML3.2">[HTML3.2]</a> and <a href="#HTML4">[HTML4]</a>, where forms are expressed in HTML, and in which the form values are sent via HTTP or electronic mail. This representation is widely implemented in numerous web browsers and web servers.  </p>
<p id="rfc.section.2.p.3">However, <samp>multipart/form-data</samp> is used for forms that are presented using representations other than HTML (spreadsheets, PDF, etc.), and for transport using means other than electronic mail or HTTP; it is used in distributed applications which do not involve forms at all, or do not have users filling out the form. For this reason, this document defines a general syntax and semantics independent of the application for which it is used, with specific rules for web applications noted in context.  </p>
<h1 id="rfc.section.3"><a href="#rfc.section.3">3.</a> Advise for Forms and Form Processing</h1>
<p id="rfc.section.3.p.1">The representation and interpretation of forms and the nature of form processing is not specified by this document.  However, for forms and form-processing that result in generation of multipart/form-data, some suggestions are included.  </p>
<p id="rfc.section.3.p.2">In a form, there are a generally series of fields, where each field is expected to be supplied with a value, e.g., by the user who fills out the form.  Each field has a name.  After a form has been filled out, and the form's data is to be 'submitted', the form processing results in a set of values for each field-- the "form data".  </p>
<p id="rfc.section.3.p.3">In forms that work with multipart/form-data, field names are Unicode strings, but restricting field names to ASCII avoids some interoperability issues.  Within a given form, insuring field names are unique is helpful.  Some fields may have default values or presupplied values in the form itself. Fields with presupplied values might be hidden or invisible.  </p>
<h1 id="rfc.section.4"><a href="#rfc.section.4">4.</a> Definition of multipart/form-data</h1>
<p id="rfc.section.4.p.1">The media-type <samp>multipart/form-data</samp> roughly follows the model of multipart MIME data streams as described in <a href="#RFC2046">[RFC2046]</a> Section 5.1; changes are noted in this document.  </p>
<pre>
        Content-Disposition: form-data; name="user"
      </pre>
<p id="rfc.section.4.p.2">A <samp>multipart/form-data</samp> body contains a series of parts.  Each part MUST contain a <samp>Content-Disposition</samp> header <a href="#RFC1806">[RFC1806]</a> <a href="#RFC2183">[RFC2183]</a> where the disposition type is <samp>form-data</samp>.  The Content-Disposition header also (optionally) contains an additional parameter of <samp>name</samp>; the value of the parameter is the original field name from the form (possibly encoded, see <a href="#non-ascii-fields">Section 6.1</a>).  For example, a part might contain a header: <samp>user</samp> field.  </p>
<h1 id="rfc.section.4.1"><a href="#rfc.section.4.1">4.1.</a> Boundary</h1>
<pre>
	    multipart/form-data;boundary="-AaB03x"
	  </pre>
<p id="rfc.section.4.1.p.1">As with other multipart types, the parts are delimited with a boundary, selected such that it does not occur in any of the data. Each field of the form is sent, in the order defined by the sending application and form, as a part of the multipart stream. The boundary is supplied as a "boundary" parameter to the multipart/form-data type, e.g., </p>
<pre>
	    multipart/form-data;boundary=-AaB03x
	  </pre>
<p id="rfc.section.4.1.p.2">Note that many sending implementations do not quote the boundary parameter, e.g., </p>
<h1 id="rfc.section.4.2"><a href="#rfc.section.4.2">4.2.</a> filename attribute</h1>
<p id="rfc.section.4.2.p.1">For form data that represents the content of a local file, a name for the file SHOULD be supplied as well, by using a <samp>filename</samp> parameter of the <samp>Content-Disposition</samp> header.  A file name isn't mandatory; file uploads might result from selection or drag-and-drop even in systems where the file name is meaningless or private, where the form data content is streamed directly from a device, or where the file name is not user visible and would be unrecognized.) </p>
<p id="rfc.section.4.2.p.2">In other multipart types, the MIME headers in each part are restricted to US-ASCII, and for compatibility with those systems, file names normally visible to users MAY be encoded (using the URL-encoding method in <a href="#percenthex">Section 5</a>; this is generally the way that a "file:" URI would be encoded.  </p>
<p id="rfc.section.4.2.p.3">However, commonly deployed systems use multipart/form-data with file names directly encoded including octets outside the US-ASCII range. The encoding used for the file names is typically UTF-8, although HTML forms will use the charset associated with the form.  </p>
<h1 id="rfc.section.4.3"><a href="#rfc.section.4.3">4.3.</a> Multiple files for one form field</h1>
<p id="rfc.section.4.3.p.1">The form data for a form field might include multiple files.</p>
<p id="rfc.section.4.3.p.2">Previously, it was suggested that multiple files for a single form field could be transmitted using a nested multipart/mixed part.  </p>
<p id="rfc.section.4.3.p.3">To match widely deployed implementations, multiple files SHOULD be sent by supplying each file in a separate part, but all with the same <samp>name</samp> parameter.  </p>
<p id="rfc.section.4.3.p.4">Reciving applications intended for wide applicability (e.g., multipart/form-data parsing libraries) SHOULD also support the older method of nesting.  </p>
<h1 id="rfc.section.4.4"><a href="#rfc.section.4.4">4.4.</a> Content-Type</h1>
<p id="rfc.section.4.4.p.1">Each part has an (optional) <samp>Content-Type</samp>, which defaults to <samp>text/plain</samp>.  If the contents of a file are to be sent, the file data SHOULD be labeled with an appropriate media type, if known, or <samp>application/octet-stream</samp>.  </p>
<h1 id="rfc.section.4.5"><a href="#rfc.section.4.5">4.5.</a> The text/plain charset parameter for text fields</h1>
<p id="rfc.section.4.5.p.1">NOTE: The examples in this document should be in Unicode using new RFC rules, and the example re-written without content-transfer-encoding, which is deprecated.</p>
<p id="rfc.section.4.5.p.2">In the case where a field value is text, the charset parameter for the <samp>text/plain</samp> Content-Type MAY be used to indicate the character encoding used in that part.  For example, a form with a text field in which a user typed "Joe owes &lt;eu&gt;100" where &lt;eu&gt; is the Euro symbol might have form data returned as: </p>
<pre>
	  --AaB03x
	  content-disposition: form-data; name="field1"
	  content-type: text/plain;charset=UTF-8
	  content-transfer-encoding: quoted-printable
	    
	  Joe owes =E2=82=AC100.
	  --AaB03x
	</pre>
<p id="rfc.section.4.5.p.3">In practice, most widely deployed implementations do not supply a charset parameter in each part, but, rather, they rely on the notion of a "default charset" for a multipart/form-data instance. Subsequent sections will explain how the default charset is established. </p>
<h1 id="rfc.section.4.6"><a href="#rfc.section.4.6">4.6.</a> The _charset_ field for default charset</h1>
<p id="rfc.section.4.6.p.1">Some form processing applications (including HTML) have the convention that the value of a form entry with entry name <samp>_charset_</samp> and type <samp>hidden</samp> is automatically set when the form is opened; the value is used as the default charset of text field values (see form-charset in <a href="#form-charset">Section 6.1.2</a>).  In such cases, the value of the default charset for each text/plain part without a charset parameter is the supplied value. For example:</p>
<pre>
	  --AaB03x
	  content-disposition: form-data; name="_charset_"
	    
	  iso8859-1
	  --AaB03x--
	  content-disposition: form-data; name="field1"
	  
	  ...text encoded in iso-8859-1 ...
	  AaB03x--
	</pre>
<h1 id="rfc.section.4.7"><a href="#rfc.section.4.7">4.7.</a> <a href="#cte" id="cte">Content-Transfer-Encoding deprecated</a></h1>
<p id="rfc.section.4.7.p.1">Previously, it was recommended that senders use a <samp>Content-Transfer-Encoding</samp> encoding (such as <samp>quoted-printable</samp>) for each non-ASCII part of a multipart/form-data body, because that would allow use in transports that only support a <samp>7BIT</samp> encoding. This use is deprecated for use in contexts that support binary data such as HTTP: senders SHOULD NOT generate any parts with a <samp>Content-Transfer-Encoding</samp> header.</p>
<p id="rfc.section.4.7.p.2">Currently, no deployed implementations that send such bodies have been discovered.</p>
<h1 id="rfc.section.4.8"><a href="#rfc.section.4.8">4.8.</a> Other Content- headers</h1>
<p id="rfc.section.4.8.p.1">The <samp>multipart/form-data</samp> media type does not support any MIME headers in the parts other than Content-Type, Content-Disposition, and (in limited circumstances) Content-Transfer-Encoding.  </p>
<h1 id="rfc.section.5"><a href="#rfc.section.5">5.</a> <a href="#percenthex" id="percenthex">URL encoding non-ASCII values</a></h1>
<p id="rfc.section.5.p.1">Within this specification, "URL-encoding" is offered as a possible way of encoidng non-ASCII characters in file names.  The encoding is created replacing each non-ASCII or disallowed character with a sequence, where each byte of the UTF-8 encoding of the character is represented by a percent-sign (%) followed by the (lower case) hexadecimal of that byte.  </p>
<h1 id="rfc.section.6"><a href="#rfc.section.6">6.</a> Operability considerations</h1>
<h1 id="rfc.section.6.1"><a href="#rfc.section.6.1">6.1.</a> <a href="#non-ascii-fields" id="non-ascii-fields">Non-ASCII field names and values</a></h1>
<p id="rfc.section.6.1.p.1">Normally, MIME headers in multipart bodies are required to consist only of 7-bit data in the US-ASCII character set.  While <a href="#RFC2388">[RFC2388]</a> suggested that non-ASCII field names should be encoded according to the method in <a href="#RFC2047">[RFC2047]</a> if they contain characters outside of US-ASCII, this practice doesn't seem to have been followed widely.  </p>
<p id="rfc.section.6.1.p.2">This specification makes three sets of recommendations for three different states of workflow.</p>
<h1 id="rfc.section.6.1.1"><a href="#rfc.section.6.1.1">6.1.1.</a> Avoid non-ASCII field names</h1>
<p id="rfc.section.6.1.1.p.1">For broadest interoperability with existing deployed software, those creating forms SHOULD avoid non-ASCII field names. This should not be a burden, because in general the field names are not visible to users.</p>
<p id="rfc.section.6.1.1.p.2">If non-ASCII field names are unavoidable, form or application creators SHOULD use UTF-8 uniformly.  This will minimize interoperability problems.  </p>
<h1 id="rfc.section.6.1.2"><a href="#rfc.section.6.1.2">6.1.2.</a> <a href="#form-charset" id="form-charset">Interpreting forms and creating form-data</a></h1>
<p id="rfc.section.6.1.2.p.1">Some applications of this specification will supply a character encoding to be used for interpretation of the multipart/form-data body. In particular, <a href="#HTML5">[HTML5]</a> uses: <a href="#percenthex">Section 5</a>.</p>

<ul>
  <li>The content of a '_charset_' field, if there is one.</li>
  <li>the value of an accept-charset attribute of the &lt;form&gt; element, if there is one,</li>
  <li>the character encoding of the document containing the form, if it is US-ASCII compatible,</li>
  <li>otherwise UTF-8.</li>
</ul>

<p> Call this the form-charset. Any field name or file name which is not in US-ASCII MUST be encoded by the URL-encoding method in </p>
<p id="rfc.section.6.1.2.p.2">multipart/form-data parts which do not have a Content-Type header and which are not the result of supplying a local file MUST be transformed by the same algorithm.  </p>
<h1 id="rfc.section.6.1.3"><a href="#rfc.section.6.1.3">6.1.3.</a> Parsing and interpreting form data</h1>
<p id="rfc.section.6.1.3.p.1">While this specification provides guidance for creation of multipart/form-data, interpreters of multipart/form-data should be aware of the variety of implementations. File systems differ as to whether and how they normalize Unicode names, for example.  </p>
<p id="rfc.section.6.1.3.p.2">Generally, interpreting <samp>multipart/form-data</samp> (even from conforming generators) may require knowing the charset used in form encoding, in cases where the _charset_ field value or a charset parameter of a text/plain Content-Type header is not supplied.  </p>
<h1 id="rfc.section.6.2"><a href="#rfc.section.6.2">6.2.</a> Ordered fields and duplicated field names</h1>
<p id="rfc.section.6.2.p.1">Form processors given forms with a well-defined ordering SHOULD send back results in the order received and preserve duplicate field names, in order.  Intermediaries MUST NOT reorder the results. (Note that there are some forms which do not define a natural order of appearance.) </p>
<h1 id="rfc.section.6.3"><a href="#rfc.section.6.3">6.3.</a> Interoperability with web applications</h1>
<p id="rfc.section.6.3.p.1">Many web applications use the "application/x-url-encoded" method for returning data from forms. This format is quite compact, e.g.: </p>
<pre>
   name=Xavier+Xantico&amp;verdict=Yes&amp;colour=Blue&amp;happy=sad&amp;Utf%F6r=Send
	</pre>
<p id="rfc.section.6.3.p.2">However, there is no opportunity to label the enclosed data with content type, apply a charset, or use other encoding mechanisms.  </p>
<p id="rfc.section.6.3.p.3">Many form-interpreting programs (primarily web browsers) now implement and generate multipart/form-data, but an existing application might need to optionally support both the application/x-url-encoded format as well.  </p>
<h1 id="rfc.section.6.4"><a href="#rfc.section.6.4">6.4.</a> Correlating form data with the original form</h1>
<p id="rfc.section.6.4.p.1">This specification provides no specific mechanism by which multipart/form-data can be associated with the form that caused it to be transmitted. This separation is intentional; many different forms might be used for transmitting the same data. In practice, applications may supply a specific form processing resource (in HTML, the ACTION attribute in a FORM tag) for each different form.  Alternatively, data about the form might be encoded in a "hidden field" (a field which is part of the form but which has a fixed value to be transmitted back to the form-data processor.) </p>
<h1 id="rfc.section.7"><a href="#rfc.section.7">7.</a> IANA Considerations</h1>
<p id="rfc.section.7.p.1">IANA please update the registration of multipart/form-data to point to this document.  </p>
<h1 id="rfc.section.8"><a href="#rfc.section.8">8.</a> <a href="#security" id="security">Security Considerations</a></h1>
<p id="rfc.section.8.p.1">It is important when interpreting the filename of the Content-Disposition header to not overwrite files in the recipient's file space inadvertently.  </p>
<p id="rfc.section.8.p.2">User applications that request form information from users must be careful not to cause a user to send information to the requestor or a third party unwillingly or unwittingly. For example, a form might request 'spam' information to be sent to an unintended third party, or private information to be sent to someone that the user might not actually intend. While this is primarily an issue for the representation and interpretation of forms themselves (rather than the data representation of the form data),  the transportation of private information must be done in a way that does not expose it to unwanted prying.  </p>
<p id="rfc.section.8.p.3">With the introduction of form-data that can reasonably send back the content of files from a user's file space, the possibility arises that a user might be sent an automated script that fills out a form and then sends one of the user's local files to another address. Thus, additional caution is required when executing automated scripting where form-data might include a user's files.  </p>
<h1 id="rfc.section.9"><a href="#rfc.section.9">9.</a> Media type registration for multipart/form-data</h1>
<p/>

<dl>
  <dt>Media Type name:</dt>
  <dd style="margin-left: 8">multipart </dd>
  <dt>Media subtype name:</dt>
  <dd style="margin-left: 8">form-data </dd>
  <dt>Required parameters:</dt>
  <dd style="margin-left: 8">boundary </dd>
  <dt>Optional parameters:</dt>
  <dd style="margin-left: 8">none </dd>
  <dt>Encoding considerations:</dt>
  <dd style="margin-left: 8">Common use is BINARY.  <br/> In limited use (or transports that restrict the encoding to 7BIT or 8BIT) each part is encoded separately using Content-Transfer-Encoding <a href="#cte">Section 4.7</a>.  </dd>
  <dt>Security considerations:</dt>
  <dd style="margin-left: 8">Applications which receive forms and process them must be careful not to supply data back to the requesting form processing site that was not intended to be sent by the recipient. This is a consideration for any application that generates a multipart/form-data.  See <a href="#security">Section 8</a> of this document.  </dd>
  <dt>Interoperability considerations:</dt>
  <dd style="margin-left: 8">This document makes several recommendations for interoperability with deployed implementations, including <a href="#cte">Section 4.7</a>.  </dd>
</dl>

<p> </p>
<h1 id="rfc.references"><a href="#rfc.references">10.</a> References</h1>
<h1 id="rfc.references.1"><a href="#rfc.references.1">10.1.</a> Normative References</h1>
<table>
  <tbody>
    <tr>
      <td class="reference">
        <b id="RFC1806">[RFC1806]</b>
      </td>
      <td class="top"><a href="mailto:rens@century.com" title="New Century Systems">Troost, R.</a> and <a href="mailto:sdorner@qualcomm.com" title="QUALCOMM Incorporated">S. Dorner</a>, "<a href="http://tools.ietf.org/html/rfc1806">Communicating Presentation Information in Internet Messages: The Content-Disposition Header</a>", RFC 1806, June 1995.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="RFC2046">[RFC2046]</b>
      </td>
      <td class="top"><a href="mailto:ned@innosoft.com" title="Innosoft International, Inc.">Freed, N.</a> and <a href="mailto:nsb@nsb.fv.com" title="First Virtual Holdings">N. Borenstein</a>, "<a href="http://tools.ietf.org/html/rfc2046">Multipurpose Internet Mail Extensions (MIME) Part Two: Media Types</a>", RFC 2046, November 1996.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="RFC2047">[RFC2047]</b>
      </td>
      <td class="top"><a href="mailto:moore@cs.utk.edu" title="University of Tennessee">Moore, K.</a>, "<a href="http://tools.ietf.org/html/rfc2047">MIME (Multipurpose Internet Mail Extensions) Part Three: Message Header Extensions for Non-ASCII Text</a>", RFC 2047, November 1996.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="RFC2183">[RFC2183]</b>
      </td>
      <td class="top"><a href="mailto:rens@century.com" title="New Century Systems">Troost, R.</a>, <a href="mailto:sdorner@qualcomm.com" title="QUALCOMM Incorporated">Dorner, S.</a> and <a href="mailto:moore@cs.utk.edu" title="Department of Computer Science">K. Moore</a>, "<a href="http://tools.ietf.org/html/rfc2183">Communicating Presentation Information in Internet Messages: The Content-Disposition Header Field</a>", RFC 2183, August 1997.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="RFC2231">[RFC2231]</b>
      </td>
      <td class="top"><a href="mailto:ned.freed@innosoft.com" title="Innosoft International, Inc.">Freed, N.</a> and <a href="mailto:moore@cs.utk.edu" title="University of Tennessee">K. Moore</a>, "<a href="http://tools.ietf.org/html/rfc2231">MIME Parameter Value and Encoded Word Extensions: Character&#160;Sets,&#160;Languages,&#160;and&#160;Continuations</a>", RFC 2231, November 1997.</td>
    </tr>
  </tbody>
</table>
<h1 id="rfc.references.2"><a href="#rfc.references.2">10.2.</a> Informative References</h1>
<table>
  <tbody>
    <tr>
      <td class="reference">
        <b id="HTML3.2">[HTML3.2]</b>
      </td>
      <td class="top"><a>Raggett, D.</a>, "<a href="http://www.w3.org/TR/REC-html32-19970114">HTML 3.2 Reference Specification</a>", World Wide Web Consortium Recommendation REC-html32-19970114, January 1997.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="HTML4">[HTML4]</b>
      </td>
      <td class="top"><a>Raggett, D.</a>, <a>Hors, A.</a> and <a>I. Jacobs</a>, "<a href="http://www.w3.org/TR/REC-html40-971218">HTML 4.0 Recommendation</a>", World Wide Web Consortium REC-html40-971218, December 1997.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="HTML5">[HTML5]</b>
      </td>
      <td class="top"><a>Berjon, R.</a>, <a>Faulkner, S.</a>, <a>Leithead, T.</a>, <a>Navara, E.</a>, <a>O'Connor, E.</a> and <a>S. Pfeiffer</a>, "<a href="http://www.w3.org/html/wg/drafts/html/CR/">HTML5</a>", September 2013.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="RFC1867">[RFC1867]</b>
      </td>
      <td class="top"><a href="mailto:nebel@xsoft.sd.xerox.com" title="XSoft, Xerox Corporation">Nebel, E.</a> and <a href="mailto:masinter@parc.xerox.com" title="Xerox Palo Alto Research Center">L. Masinter</a>, "<a href="http://tools.ietf.org/html/rfc1867">Form-based File Upload in HTML</a>", RFC 1867, November 1995.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="RFC2388">[RFC2388]</b>
      </td>
      <td class="top"><a href="mailto:masinter@parc.xerox.com" title="Xerox Palo Alto Research Center">Masinter, L.</a>, "<a href="http://tools.ietf.org/html/rfc2388">Returning Values from Forms:  multipart/form-data</a>", RFC 2388, August 1998.</td>
    </tr>
  </tbody>
</table>
<h1 id="rfc.appendix.A"><a href="#rfc.appendix.A">Appendix A.</a> Changes from RFC 2388</h1>
<p id="rfc.section.A.p.1">The handling of non-ASCII field names changed-- no longer recommending the RFC 2047 method, instead suggesting senders send UTF-8 field names directly, and file names directly in the form-charset.  </p>
<p id="rfc.section.A.p.2">The handling of multiple files submitted as the result of a single form field (e.g., HTML's &lt;input type=file multiple&gt; element) results in each file having its own top level part with the same name parameter; the method of using a nested <samp>multipart/mixed</samp> from <a href="#RFC2388">[RFC2388]</a> is no longer recommended for creators, and not required for recievers as there are no known implementations of senders.  </p>
<p id="rfc.section.A.p.3">The _charset_ convention and use of an explicit form-data charset is documented.  </p>
<p id="rfc.section.A.p.4">'boundary' is a required parameter in Content-Type.  </p>
<p id="rfc.section.A.p.5">The relationship of the ordeng of fields within a form and the ordering of returned values within multipart/form-data was not defined before, nor was the handling of the case where a form has multiple fields with the same name.  </p>
<p id="rfc.section.A.p.6">Editorial: Removed obsolete discussion of alternatives in appendix.  Update references. Move outline of form processing into Introduction.  </p>
<h1 id="rfc.appendix.B"><a href="#rfc.appendix.B">Appendix B.</a> Alternatives</h1>
<p id="rfc.section.B.p.1">There are numerous alternative ways in which form data can be encoded; many are listed in <a href="#RFC2388">[RFC2388]</a> section 5.2.  The multipart/form-data encoding is verbose, especially if there are many fields with short values. In most use cases, this overhead isn't significant. </p>
<p id="rfc.section.B.p.2">More problematic is the ambiguity introduced because implementations did not follow <a href="#RFC2388">[RFC2388]</a> because it used "may" instead of "MUST" when specifying encoding of field names, and for other unknown reasons, so now, parsers need to be more complex for fuzzy matching against the possible outputs of various encoding methods.  </p>
<h1 id="rfc.authors">
  <a href="#rfc.authors">Author's Address</a>
</h1>
<div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Larry Masinter</span> 
	  <span class="n hidden">
		<span class="family-name">Masinter</span>
	  </span>
	</span>
	<span class="org vcardline">Adobe</span>
	<span class="adr">
	  
	  <span class="vcardline">
		<span class="locality"></span> 
		<span class="region"></span>
		<span class="code"></span>
	  </span>
	  <span class="country-name vcardline"></span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:masinter@adobe.com">masinter@adobe.com</a></span>

<span class="vcardline">URI: <a href="http://larry.masinter.net">http://larry.masinter.net</a></span>

  </address>
</div>

</body>
</html>
